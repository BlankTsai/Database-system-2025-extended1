<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>二手交易網站</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>二手交易網站</h1>
        
        <div class="nav-bar">
            <a href="{{ url_for('add_product') }}" class="nav-link add-product-btn">+ 上架新商品</a>
            <a href="{{ url_for('dashboard') }}" class="nav-link" style="background-color: #6f42c1; color: white;">前往管理後台</a>
        </div>

        <div class="search-section card">
            <form action="{{ url_for('index') }}" method="GET" style="display: flex; gap: 10px;">
                <input type="text" name="q" placeholder="搜尋商品名稱..." value="{{ search_query or '' }}">
                <button type="submit">搜尋</button>
                {% if search_query %}
                    <a href="{{ url_for('index') }}" class="cancel-btn" style="padding: 12px;">清除</a>
                {% endif %}
            </form>
        </div>

        <div class="product-list">
            <h2>商品列表 {% if search_query %}(搜尋結果: {{ search_query }}){% endif %}</h2>
            
            {% if products %}
                {% for product in products %}
                    <div class="product-card card">
                        <h3>{{ product.name }}</h3>
                        <p class="price">$ {{ product.price | round(2) }}</p> <p class="description">{{ product.description }}</p>
                        <small>上架時間: {{ product.created_at }}</small>
                        <div class="action-buttons">
                            <a href="{{ url_for('edit_product', product_id=product._id) }}" class="edit-btn">編輯</a>
                            <form action="{{ url_for('delete_product', product_id=product._id) }}" method="POST" style="display: inline;">
                                <button type="submit" class="delete-btn" onclick="return confirm('確定要刪除嗎？')">刪除</button>
                            </form>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p>找不到任何商品。</p>
            {% endif %}
        </div>
    </div>
</body>
</html>